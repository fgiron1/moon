---
- name: Install mobile interface requirements
  apt:
    name:
      - ncurses-bin
      - dialog
      - figlet
      - lolcat
    state: present
    
- name: Create mobile interface directory
  file:
    path: "/opt/osint/mobile"
    state: directory
    mode: 0755
    
- name: Copy campo mobile interface script
  template:
    src: campo_menu.sh.j2
    dest: "/usr/local/bin/campo"
    mode: 0755
    
- name: Create mobile user
  user:
    name: campo
    shell: /usr/local/bin/campo
    create_home: yes
    home: /home/campo
    groups: sudo
    
- name: Set up bash profile for campo user
  copy:
    dest: /home/campo/.bash_profile
    content: |
      #!/bin/bash
      exec /usr/local/bin/campo
    mode: 0644
    owner: campo
    group: campo
    
- name: Create data directories for campo user
  file:
    path: "/home/campo/{{ item }}"
    state: directory
    mode: 0755
    owner: campo
    group: campo
  loop:
    - "data"
    - "reports"
    - "downloads"
    
- name: Create symbolic links to OSINT tools
  file:
    src: "{{ osint_tools_dir }}"
    dest: "/home/campo/tools"
    state: link
    owner: campo
    group: campo
    
- name: Set user campo to run specific commands without password
  lineinfile:
    path: /etc/sudoers.d/campo
    line: "campo ALL=(ALL) NOPASSWD: /usr/bin/nmap, /usr/sbin/hcitool, /usr/bin/iwlist, /sbin/ip, /usr/sbin/vpn, /usr/local/bin/tor-control, /usr/local/bin/osint-network"
    create: yes
    mode: 0440